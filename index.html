<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zeyvə Weather</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #3a86ff;
            --secondary: #2667cc;
            --accent: #ff006e;
            --light: #f8f9fa;
            --dark: #212529;
            --success: #38b000;
            --warning: #ff9e00;
            --danger: #ef476f;
            --card-bg: rgba(255, 255, 255, 0.95);
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            --radius: 16px;
            --transition: all 0.3s ease;
        }

        .theme-dark {
            --primary: #8338ec;
            --secondary: #5a24c4;
            --accent: #fb5607;
            --light: #121212;
            --dark: #e9ecef;
            --card-bg: rgba(30, 30, 30, 0.95);
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .theme-nature {
            --primary: #2a9d8f;
            --secondary: #21867a;
            --accent: #e9c46a;
        }

        .theme-sunset {
            --primary: #ff6b6b;
            --secondary: #ff5252;
            --accent: #ffd166;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
        }

        body {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: var(--dark);
            min-height: 100vh;
            padding: 15px;
            transition: var(--transition);
        }

        .container {
            max-width: 100%;
            margin: 0 auto;
        }

        .app-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .location-info {
            display: flex;
            align-items: center;
            gap: 10px;
            color: white;
        }

        .location-info h1 {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .location-info i {
            font-size: 1.2rem;
        }

        .controls {
            display: flex;
            gap: 10px;
        }

        .control-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            backdrop-filter: blur(10px);
        }

        .control-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }

        .card {
            background: var(--card-bg);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 20px;
            transition: var(--transition);
            backdrop-filter: blur(10px);
            margin-bottom: 15px;
        }

        .current-weather {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            color: var(--dark);
        }

        .temp-container {
            display: flex;
            align-items: center;
            margin: 15px 0;
        }

        .temperature {
            font-size: 3.5rem;
            font-weight: 300;
            line-height: 1;
        }

        .weather-icon {
            font-size: 3rem;
            margin-left: 15px;
            color: var(--primary);
        }

        .description {
            font-size: 1.3rem;
            margin-bottom: 15px;
            text-transform: capitalize;
            font-weight: 500;
        }

        .weather-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            width: 100%;
            margin-top: 15px;
        }

        .detail-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 12px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 10px;
        }

        .detail-item i {
            font-size: 1.3rem;
            margin-bottom: 5px;
            color: var(--primary);
        }

        .detail-label {
            font-size: 0.8rem;
            opacity: 0.7;
            margin-bottom: 3px;
        }

        .detail-value {
            font-size: 1rem;
            font-weight: 600;
        }

        .section-title {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 15px;
            font-size: 1.1rem;
            font-weight: 600;
        }

        .section-title i {
            color: var(--primary);
        }

        .hourly-forecast {
            display: flex;
            overflow-x: auto;
            gap: 12px;
            padding: 8px 5px;
            margin-bottom: 15px;
            -webkit-overflow-scrolling: touch;
        }

        .hourly-item {
            flex: 0 0 auto;
            width: 70px;
            text-align: center;
            padding: 12px 8px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 10px;
            transition: var(--transition);
        }

        .hour-time {
            font-weight: 600;
            margin-bottom: 5px;
            font-size: 0.85rem;
        }

        .hour-icon {
            font-size: 1.5rem;
            margin: 5px 0;
            color: var(--primary);
        }

        .hour-temp {
            font-weight: 600;
            font-size: 0.9rem;
        }

        .daily-forecast {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .daily-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 10px;
            transition: var(--transition);
        }

        .day-info {
            display: flex;
            align-items: center;
            gap: 10px;
            flex: 1;
        }

        .day-name {
            font-weight: 600;
            width: 80px;
            font-size: 0.9rem;
        }

        .day-icon {
            font-size: 1.5rem;
            width: 30px;
            text-align: center;
            color: var(--primary);
        }

        .day-description {
            flex: 1;
            text-transform: capitalize;
            font-size: 0.85rem;
        }

        .day-temps {
            display: flex;
            gap: 10px;
        }

        .day-high {
            font-weight: 600;
            font-size: 0.9rem;
        }

        .day-low {
            opacity: 0.7;
            font-size: 0.9rem;
        }

        .additional-data {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 15px;
        }

        .data-card {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px;
            background: var(--card-bg);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .data-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            color: var(--primary);
        }

        .data-value {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 3px;
        }

        .data-label {
            font-size: 0.8rem;
            opacity: 0.7;
        }

        .air-quality {
            position: relative;
            overflow: hidden;
        }

        .aqi-scale {
            display: flex;
            margin: 12px 0;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        }

        .aqi-level {
            flex: 1;
            text-align: center;
            padding: 8px 3px;
            font-size: 0.7rem;
            font-weight: 600;
            transition: var(--transition);
        }

        .aqi-level[data-level="1"] { background: #00e400; color: black; }
        .aqi-level[data-level="2"] { background: #ffff00; color: black; }
        .aqi-level[data-level="3"] { background: #ff7e00; color: white; }
        .aqi-level[data-level="4"] { background: #ff0000; color: white; }
        .aqi-level[data-level="5"] { background: #8f3f97; color: white; }

        .pollutants {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 12px;
        }

        .pollutant {
            text-align: center;
        }

        .pollutant-value {
            font-size: 1rem;
            font-weight: 600;
        }

        .pollutant-label {
            font-size: 0.75rem;
            opacity: 0.7;
        }

        .theme-selector {
            position: fixed;
            bottom: 15px;
            right: 15px;
            background: var(--card-bg);
            border-radius: 50px;
            padding: 8px;
            display: flex;
            gap: 8px;
            box-shadow: var(--shadow);
            z-index: 100;
        }

        .theme-btn {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            transition: var(--transition);
        }

        .theme-btn.active {
            box-shadow: 0 0 0 2px var(--card-bg), 0 0 0 4px var(--primary);
        }

        .theme-light { background: linear-gradient(135deg, #3a86ff 0%, #2667cc 100%); }
        .theme-dark { background: linear-gradient(135deg, #121212 0%, #333 100%); }
        .theme-nature { background: linear-gradient(135deg, #2a9d8f 0%, #21867a 100%); }
        .theme-sunset { background: linear-gradient(135deg, #ff6b6b 0%, #ff5252 100%); }

        .loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px;
            text-align: center;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s linear infinite;
            margin-bottom: 15px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .error {
            text-align: center;
            padding: 25px;
            color: var(--danger);
            background: rgba(239, 71, 111, 0.1);
            border-radius: 10px;
            margin: 15px 0;
        }

        .api-badge {
            position: absolute;
            top: 12px;
            right: 12px;
            background: var(--primary);
            color: white;
            padding: 4px 8px;
            border-radius: 15px;
            font-size: 0.65rem;
            font-weight: 600;
        }

        .notification {
            position: fixed;
            top: 15px;
            right: 15px;
            background: var(--success);
            color: white;
            padding: 12px 15px;
            border-radius: 8px;
            box-shadow: var(--shadow);
            transform: translateX(150%);
            transition: transform 0.3s ease;
            z-index: 1000;
            font-size: 0.9rem;
        }

        .notification.show {
            transform: translateX(0);
        }

        .tab-navigation {
            display: flex;
            background: var(--card-bg);
            border-radius: 12px;
            padding: 5px;
            margin-bottom: 15px;
            box-shadow: var(--shadow);
        }

        .tab-btn {
            flex: 1;
            padding: 10px;
            border: none;
            background: transparent;
            border-radius: 8px;
            font-weight: 500;
            color: var(--dark);
            cursor: pointer;
            transition: var(--transition);
        }

        .tab-btn.active {
            background: var(--primary);
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Mobile-specific adjustments */
        @media (max-width: 480px) {
            body {
                padding: 10px;
            }
            
            .location-info h1 {
                font-size: 1.3rem;
            }
            
            .temperature {
                font-size: 3rem;
            }
            
            .weather-icon {
                font-size: 2.5rem;
            }
            
            .description {
                font-size: 1.1rem;
            }
            
            .additional-data {
                grid-template-columns: 1fr;
            }
            
            .theme-selector {
                bottom: 10px;
                right: 10px;
            }
        }

        @media (max-width: 360px) {
            .weather-details {
                grid-template-columns: 1fr;
            }
            
            .hourly-item {
                width: 65px;
                padding: 10px 5px;
            }
            
            .day-name {
                width: 70px;
            }
        }

        /* Improve touch targets */
        button, .hourly-item, .daily-item {
            cursor: pointer;
            -webkit-tap-highlight-color: transparent;
        }

        /* Prevent text selection on interactive elements */
        .control-btn, .tab-btn, .theme-btn {
            user-select: none;
            -webkit-user-select: none;
        }
    </style>
</head>
<body class="theme-light">
    <div class="container">
        <div class="app-header">
            <div class="location-info">
                <i class="fas fa-map-marker-alt"></i>
                <div>
                    <h1>Zeyvə, Şabran</h1>
                    <div id="currentDateTime">Updating...</div>
                </div>
            </div>
            <div class="controls">
                <button class="control-btn" id="refreshBtn" title="Refresh">
                    <i class="fas fa-sync-alt"></i>
                </button>
                <button class="control-btn" id="settingsBtn" title="Settings">
                    <i class="fas fa-cog"></i>
                </button>
            </div>
        </div>

        <div class="tab-navigation">
            <button class="tab-btn active" data-tab="current">Current</button>
            <button class="tab-btn" data-tab="hourly">Hourly</button>
            <button class="tab-btn" data-tab="daily">7-Day</button>
            <button class="tab-btn" data-tab="details">Details</button>
        </div>

        <div id="weatherContent">
            <div class="loading">
                <div class="loading-spinner"></div>
                <h3>Loading weather data...</h3>
                <p>Fetching from multiple sources</p>
            </div>
        </div>

        <div class="tab-content active" id="current-tab">
            <div class="card air-quality">
                <div class="api-badge">Open-Meteo</div>
                <div class="section-title">
                    <i class="fas fa-wind"></i>
                    <h2>Air Quality</h2>
                </div>
                <div class="aqi-scale">
                    <div class="aqi-level" data-level="1">Good</div>
                    <div class="aqi-level" data-level="2">Moderate</div>
                    <div class="aqi-level" data-level="3">Sensitive</div>
                    <div class="aqi-level" data-level="4">Unhealthy</div>
                    <div class="aqi-level" data-level="5">Bad</div>
                </div>
                <div class="pollutants">
                    <div class="pollutant">
                        <div class="pollutant-value" id="pm25">-</div>
                        <div class="pollutant-label">PM2.5</div>
                    </div>
                    <div class="pollutant">
                        <div class="pollutant-value" id="pm10">-</div>
                        <div class="pollutant-label">PM10</div>
                    </div>
                    <div class="pollutant">
                        <div class="pollutant-value" id="aqi">-</div>
                        <div class="pollutant-label">AQI</div>
                    </div>
                    <div class="pollutant">
                        <div class="pollutant-value" id="o3">-</div>
                        <div class="pollutant-label">O₃</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-content" id="hourly-tab">
            <div class="card">
                <div class="section-title">
                    <i class="fas fa-clock"></i>
                    <h2>24-Hour Forecast</h2>
                </div>
                <div class="hourly-forecast" id="hourlyForecast">
                    <!-- Hourly forecast will be inserted here -->
                </div>
            </div>
        </div>

        <div class="tab-content" id="daily-tab">
            <div class="card">
                <div class="section-title">
                    <i class="fas fa-calendar-alt"></i>
                    <h2>7-Day Forecast</h2>
                </div>
                <div class="daily-forecast" id="dailyForecast">
                    <!-- Daily forecast will be inserted here -->
                </div>
            </div>
        </div>

        <div class="tab-content" id="details-tab">
            <div class="additional-data" id="additionalData">
                <!-- Additional data cards will be inserted here -->
            </div>
        </div>
    </div>

    <div class="theme-selector">
        <button class="theme-btn theme-light active" data-theme="light" title="Light Theme"></button>
        <button class="theme-btn theme-dark" data-theme="dark" title="Dark Theme"></button>
        <button class="theme-btn theme-nature" data-theme="nature" title="Nature Theme"></button>
        <button class="theme-btn theme-sunset" data-theme="sunset" title="Sunset Theme"></button>
    </div>

    <div class="notification" id="notification">
        <i class="fas fa-check-circle"></i> Data updated
    </div>

    <script>
        // Zeyvə coordinates
        const LATITUDE = 41.1703;
        const LONGITUDE = 49.0817;
        
        // DOM elements
        const weatherContent = document.getElementById('weatherContent');
        const refreshBtn = document.getElementById('refreshBtn');
        const currentDateTime = document.getElementById('currentDateTime');
        const hourlyForecast = document.getElementById('hourlyForecast');
        const dailyForecast = document.getElementById('dailyForecast');
        const additionalData = document.getElementById('additionalData');
        const notification = document.getElementById('notification');
        const tabBtns = document.querySelectorAll('.tab-btn');
        const tabContents = document.querySelectorAll('.tab-content');
        
        // Weather codes and descriptions
        const weatherCodes = {
            0: { description: "Clear sky", icon: "fa-sun", color: "#ffd166" },
            1: { description: "Mainly clear", icon: "fa-cloud-sun", color: "#ffd166" },
            2: { description: "Partly cloudy", icon: "fa-cloud", color: "#8ecae6" },
            3: { description: "Overcast", icon: "fa-cloud", color: "#8ecae6" },
            45: { description: "Fog", icon: "fa-smog", color: "#adb5bd" },
            48: { description: "Depositing rime fog", icon: "fa-smog", color: "#adb5bd" },
            51: { description: "Light drizzle", icon: "fa-cloud-rain", color: "#3a86ff" },
            53: { description: "Moderate drizzle", icon: "fa-cloud-rain", color: "#3a86ff" },
            55: { description: "Dense drizzle", icon: "fa-cloud-showers-heavy", color: "#3a86ff" },
            56: { description: "Light freezing drizzle", icon: "fa-cloud-rain", color: "#3a86ff" },
            57: { description: "Dense freezing drizzle", icon: "fa-cloud-showers-heavy", color: "#3a86ff" },
            61: { description: "Slight rain", icon: "fa-cloud-rain", color: "#3a86ff" },
            63: { description: "Moderate rain", icon: "fa-cloud-rain", color: "#3a86ff" },
            65: { description: "Heavy rain", icon: "fa-cloud-showers-heavy", color: "#3a86ff" },
            66: { description: "Light freezing rain", icon: "fa-cloud-rain", color: "#3a86ff" },
            67: { description: "Heavy freezing rain", icon: "fa-cloud-showers-heavy", color: "#3a86ff" },
            71: { description: "Slight snow fall", icon: "fa-snowflake", color: "#90e0ef" },
            73: { description: "Moderate snow fall", icon: "fa-snowflake", color: "#90e0ef" },
            75: { description: "Heavy snow fall", icon: "fa-snowflake", color: "#90e0ef" },
            77: { description: "Snow grains", icon: "fa-snowflake", color: "#90e0ef" },
            80: { description: "Slight rain showers", icon: "fa-cloud-rain", color: "#3a86ff" },
            81: { description: "Moderate rain showers", icon: "fa-cloud-showers-heavy", color: "#3a86ff" },
            82: { description: "Violent rain showers", icon: "fa-cloud-showers-heavy", color: "#3a86ff" },
            85: { description: "Slight snow showers", icon: "fa-snowflake", color: "#90e0ef" },
            86: { description: "Heavy snow showers", icon: "fa-snowflake", color: "#90e0ef" },
            95: { description: "Thunderstorm", icon: "fa-bolt", color: "#ff9e00" },
            96: { description: "Thunderstorm with slight hail", icon: "fa-bolt", color: "#ff9e00" },
            99: { description: "Thunderstorm with heavy hail", icon: "fa-bolt", color: "#ff9e00" }
        };
        
        // API sources
        const apiSources = {
            openMeteo: {
                name: "Open-Meteo",
                url: `https://api.open-meteo.com/v1/forecast?latitude=${LATITUDE}&longitude=${LONGITUDE}&current_weather=true&hourly=temperature_2m,relativehumidity_2m,apparent_temperature,precipitation_probability,weathercode,windspeed_10m,winddirection_10m,visibility,pressure_msl,uv_index&daily=weathercode,temperature_2m_max,temperature_2m_min,apparent_temperature_max,apparent_temperature_min,precipitation_sum,precipitation_probability_max,windspeed_10m_max,winddirection_10m_dominant,sunrise,sunset,uv_index_max&timezone=auto`
            },
            airQuality: {
                name: "Air Quality",
                url: `https://air-quality-api.open-meteo.com/v1/air-quality?latitude=${LATITUDE}&longitude=${LONGITUDE}&hourly=pm10,pm2_5,ozone&timezone=auto`
            }
        };
        
        // Update current date and time
        function updateDateTime() {
            const now = new Date();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            };
            currentDateTime.textContent = now.toLocaleDateString('en-US', options);
        }
        
        // Show notification
        function showNotification(message) {
            notification.innerHTML = `<i class="fas fa-check-circle"></i> ${message}`;
            notification.classList.add('show');
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // Load weather data
        async function loadWeatherData() {
            try {
                // Fetch data from multiple APIs
                const [weatherData, airQualityData] = await Promise.all([
                    fetchData(apiSources.openMeteo.url),
                    fetchData(apiSources.airQuality.url)
                ]);
                
                displayWeatherData(weatherData, airQualityData);
                showNotification('Data updated');
            } catch (error) {
                console.error('Failed to load weather data:', error);
                showError('Failed to load weather data. Please try again.');
            }
        }
        
        // Fetch data from API
        async function fetchData(url) {
            const response = await fetch(url);
            if (!response.ok) {
                throw new Error(`API error: ${response.status}`);
            }
            return await response.json();
        }
        
        // Display weather data
        function displayWeatherData(weatherData, airQualityData) {
            const current = weatherData.current_weather;
            const hourly = weatherData.hourly;
            const daily = weatherData.daily;
            
            // Get weather info based on code
            const currentWeatherCode = current.weathercode;
            const currentWeatherInfo = weatherCodes[currentWeatherCode] || { description: "Unknown", icon: "fa-question", color: "#6c757d" };
            
            // Additional info
            const apparentTemp = Math.round(hourly.apparent_temperature[0]);
            const humidity = hourly.relativehumidity_2m[0];
            const precipitationProb = hourly.precipitation_probability[0];
            const visibility = (hourly.visibility[0] / 1000).toFixed(1);
            const pressure = Math.round(hourly.pressure_msl[0]);
            const uvIndex = hourly.uv_index[0];
            const windDirection = getWindDirection(current.winddirection);
            
            // Air quality data
            let pm25 = "-";
            let pm10 = "-";
            let o3 = "-";
            let aqi = "-";
            
            if (airQualityData) {
                pm25 = airQualityData.hourly.pm2_5[0].toFixed(1);
                pm10 = airQualityData.hourly.pm10[0].toFixed(1);
                o3 = airQualityData.hourly.ozone[0].toFixed(1);
                
                // Calculate AQI
                const aqiValue = Math.max(
                    calculateAQI(pm25, 'pm25'),
                    calculateAQI(pm10, 'pm10')
                );
                aqi = Math.round(aqiValue);
                
                // Update air quality values
                document.getElementById('pm25').textContent = pm25;
                document.getElementById('pm10').textContent = pm10;
                document.getElementById('o3').textContent = o3;
                document.getElementById('aqi').textContent = aqi;
            }
            
            // Current weather section
            const currentWeatherHTML = `
                <div class="card current-weather">
                    <div class="temp-container">
                        <div class="temperature">${Math.round(current.temperature)}°C</div>
                        <div class="weather-icon"><i class="fas ${currentWeatherInfo.icon}" style="color: ${currentWeatherInfo.color}"></i></div>
                    </div>
                    <div class="description">${currentWeatherInfo.description}</div>
                    <div class="weather-details">
                        <div class="detail-item">
                            <i class="fas fa-temperature-low"></i>
                            <div class="detail-label">Feels like</div>
                            <div class="detail-value">${apparentTemp}°C</div>
                        </div>
                        <div class="detail-item">
                            <i class="fas fa-wind"></i>
                            <div class="detail-label">Wind</div>
                            <div class="detail-value">${current.windspeed} km/h</div>
                        </div>
                        <div class="detail-item">
                            <i class="fas fa-tint"></i>
                            <div class="detail-label">Humidity</div>
                            <div class="detail-value">${humidity}%</div>
                        </div>
                        <div class="detail-item">
                            <i class="fas fa-cloud-rain"></i>
                            <div class="detail-label">Precipitation</div>
                            <div class="detail-value">${precipitationProb}%</div>
                        </div>
                    </div>
                </div>
            `;
            
            // Additional data cards
            const additionalDataHTML = `
                <div class="data-card">
                    <i class="fas fa-eye data-icon"></i>
                    <div class="data-value">${visibility} km</div>
                    <div class="data-label">Visibility</div>
                </div>
                <div class="data-card">
                    <i class="fas fa-gauge-high data-icon"></i>
                    <div class="data-value">${pressure} hPa</div>
                    <div class="data-label">Pressure</div>
                </div>
                <div class="data-card">
                    <i class="fas fa-sun data-icon"></i>
                    <div class="data-value">${uvIndex}</div>
                    <div class="data-label">UV Index</div>
                </div>
                <div class="data-card">
                    <i class="fas fa-compass data-icon"></i>
                    <div class="data-value">${windDirection}</div>
                    <div class="data-label">Wind Direction</div>
                </div>
            `;
            
            // Hourly forecast
            let hourlyHTML = '';
            const now = new Date();
            const currentHour = now.getHours();
            
            for (let i = 0; i < 24; i += 2) {
                const hourIndex = (currentHour + i) % 24;
                const hourTime = hourly.time[hourIndex];
                const hourTemp = Math.round(hourly.temperature_2m[hourIndex]);
                const hourCode = hourly.weathercode[hourIndex];
                const hourInfo = weatherCodes[hourCode] || { description: "Unknown", icon: "fa-question", color: "#6c757d" };
                
                // Format hour
                const hour = new Date(hourTime).getHours();
                const displayHour = hour === 0 ? '12 AM' : hour < 12 ? `${hour} AM` : hour === 12 ? '12 PM' : `${hour-12} PM`;
                
                hourlyHTML += `
                    <div class="hourly-item">
                        <div class="hour-time">${displayHour}</div>
                        <div class="hour-icon"><i class="fas ${hourInfo.icon}" style="color: ${hourInfo.color}"></i></div>
                        <div class="hour-temp">${hourTemp}°</div>
                    </div>
                `;
            }
            
            // Daily forecast
            let dailyHTML = '';
            const dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            
            for (let i = 0; i < 7; i++) {
                const dayCode = daily.weathercode[i];
                const dayInfo = weatherCodes[dayCode] || { description: "Unknown", icon: "fa-question", color: "#6c757d" };
                const dayName = i === 0 ? 'Today' : dayNames[new Date(daily.time[i]).getDay()];
                
                dailyHTML += `
                    <div class="daily-item">
                        <div class="day-info">
                            <div class="day-name">${dayName}</div>
                            <div class="day-icon"><i class="fas ${dayInfo.icon}" style="color: ${dayInfo.color}"></i></div>
                            <div class="day-description">${dayInfo.description}</div>
                        </div>
                        <div class="day-temps">
                            <div class="day-high">${Math.round(daily.temperature_2m_max[i])}°</div>
                            <div class="day-low">${Math.round(daily.temperature_2m_min[i])}°</div>
                        </div>
                    </div>
                `;
            }
            
            // Update HTML content
            weatherContent.innerHTML = currentWeatherHTML;
            additionalData.innerHTML = additionalDataHTML;
            hourlyForecast.innerHTML = hourlyHTML;
            dailyForecast.innerHTML = dailyHTML;
        }
        
        // Calculate AQI
        function calculateAQI(value, pollutant) {
            if (pollutant === 'pm25') {
                if (value <= 12) return (50/12) * value;
                else if (value <= 35.4) return 50 + (50/(35.4-12)) * (value - 12);
                else if (value <= 55.4) return 100 + (50/(55.4-35.4)) * (value - 35.4);
                else if (value <= 150.4) return 150 + (100/(150.4-55.4)) * (value - 55.4);
                else return 301;
            } else if (pollutant === 'pm10') {
                if (value <= 54) return value;
                else if (value <= 154) return 55 + (45/(154-55)) * (value - 55);
                else if (value <= 254) return 100 + (50/(254-155)) * (value - 155);
                else if (value <= 354) return 150 + (100/(354-255)) * (value - 255);
                else return 301;
            }
            return 0;
        }
        
        // Get wind direction
        function getWindDirection(degrees) {
            const directions = ['N', 'NNE', 'NE', 'ENE', 'E', 'ESE', 'SE', 'SSE', 'S', 'SSW', 'SW', 'WSW', 'W', 'WNW', 'NW', 'NNW'];
            const index = Math.round(degrees / 22.5) % 16;
            return directions[index];
        }
        
        // Change theme
        function changeTheme(theme) {
            document.body.className = `theme-${theme}`;
            localStorage.setItem('weatherAppTheme', theme);
            
            // Update active theme button
            document.querySelectorAll('.theme-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`.theme-btn[data-theme="${theme}"]`).classList.add('active');
        }
        
        // Show error message
        function showError(message) {
            weatherContent.innerHTML = `
                <div class="error">
                    <i class="fas fa-exclamation-triangle"></i>
                    <h3>Error</h3>
                    <p>${message}</p>
                    <button class="control-btn" onclick="loadWeatherData()" style="margin-top: 15px;">
                        <i class="fas fa-sync-alt"></i> Try Again
                    </button>
                </div>
            `;
        }
        
        // Switch tabs
        function switchTab(tabName) {
            // Update tab buttons
            tabBtns.forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`.tab-btn[data-tab="${tabName}"]`).classList.add('active');
            
            // Update tab content
            tabContents.forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`${tabName}-tab`).classList.add('active');
        }
        
        // Page loaded
        document.addEventListener('DOMContentLoaded', () => {
            // Load saved theme
            const savedTheme = localStorage.getItem('weatherAppTheme') || 'light';
            changeTheme(savedTheme);
            
            updateDateTime();
            loadWeatherData();
            
            // Update time every minute
            setInterval(updateDateTime, 60000);
            
            // Refresh data every 10 minutes
            setInterval(loadWeatherData, 600000);
        });
        
        // Refresh button
        refreshBtn.addEventListener('click', () => {
            loadWeatherData();
            // Animation
            refreshBtn.style.transform = 'rotate(180deg)';
            setTimeout(() => {
                refreshBtn.style.transform = 'rotate(0deg)';
            }, 500);
        });
        
        // Theme buttons
        document.querySelectorAll('.theme-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                changeTheme(btn.dataset.theme);
            });
        });
        
        // Tab buttons
        tabBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                switchTab(btn.dataset.tab);
            });
        });
        
        // Settings button
        document.getElementById('settingsBtn').addEventListener('click', () => {
            showNotification('Settings menu coming soon');
        });
    </script>
</body>

</html>
